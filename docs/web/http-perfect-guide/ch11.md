---
sidebar_position: 11
---

# 11. 클라이언트 식별과 쿠키

- 웹 서버는 서로 다른 수천 개의 클라이언트들과 동시에 통신합니다.
- 때로는 모든 요청을 처리하는 것 뿐만 아니라 서버와 통신하고 있는 클라이언트를 추적해야 할 수도 있습니다.
- 아래에서는 서버가 통신하는 대상을 식별하는 데 사용하는 기술입니다.

## 11.1 개별 접촉

- HTTP는 익명으로 사용하며 상태가 없으며 요청과 응답으로 통신하는 프로토콜입니다.
- 웹 사이트는 요청을 보낸 사용자를 식별하거나 방문자가 보낸 연속적인 요청을 추적하기 위해 약간의 정보를 이용할 수 있습니다.
  - **개별 인사**, (사용자에게 특화된 환영 메시지나 페이지 내용을 만듭니다.)
  - 사용자 맞춤 추천, 온라인 상점은 고객이 좋아할 것이라 예상되는 제품들을 추천합니다.
  - 저장된 사용자 정보, 복잡한 주소와 신용카드 정보를 데이터베이스에 저장함으로 편리함을 제공합니다.
  - 세션 추적, HTTP 트랜잭션은 상태가 없습니다. 그렇기 때문에 사용자의 상태를 남기기 위해 사용자에게서 오는 HTTP 트랜잭션을 식별할 방법이 필요합니다.

아래에서는 사용자를 식별하는 기술입니다. (각기 장단점이 있습니다.)

- 사용자 식별 관련 정보를 전달하는 HTTP 헤더들
- 클라이언트 IP 주소 추적으로 알아낸 IP 주소로 사용자를 식별
- 사용자 로그인 인증을 통한 사용자 식별
- URL에 식별자를 포함하는 기술인 뚱뚱한 URL
- 식별 정보를 지속해서 유지하는 강력하고 효율적인 쿠키

<br/>

## 11.2 HTTP 헤더

사용자에 대한 정보를 전달하는 HTTP 헤더

| 헤더 이름       | 헤더 타입  | 설명                                     |
| --------------- | ---------- | ---------------------------------------- |
| From            | 요청       | 사용자의 이메일 주소                     |
| User-Agent      | 요청       | 사용자의 브라우저                        |
| Referer         | 요청       | 사용자가 현재 링크를 타고 온 근원 페이지 |
| Authorization   | 요청       | 사용자 이름과 비밀번호                   |
| Client-ip       | 확장(요청) | 클라이언트의 IP 주소                     |
| X-Forwarded-For | 확장(요청) | 클라이언트의 IP 주소                     |
| Cookie          | 확장(요청) | 서버가 생성한 ID 라벨                    |

<br/>

## 11.3 클라이언트 IP 주소

초기에는 웹에서는 사용자 식별에 클라이언트의 IP 주소를 사용했습니다. 그러나 아래의 약점을 가집니다.

- 클라이언트 IP 주소는 사용자가 아닌 사용하는 컴퓨터를 의미합니다.
- 많은 인터넷 서비스 제공자(ISP)는 사용자가 로그인하면 동적으로 IP 주소를 할당합니다.
- 보안을 강화하고 부족한 주소들을 관리하려고 많은 사용자가 네트워크 주소 변화 방화벽을 통해 인터넷을 사용합니다.
- 보통 HTTP 프락시와 게이트웨이는 원 서버에 새로운 TCP 연결을 합니다.

현재도 세션 간에 사용자를 추적하려고 클라이언트 IP 주소를 사용하는 웹사이트가 있으나 이 방식은 제대로 동작하지 않기 때문에 사용하지 않습니다.

<br/>

## 11.4 사용자 로그인

- IP 주소로 사용자를 식별하려는 수동적인 방식보다, 웹 서버는 사용자 이름과 비밀번호로 인증할 것을 요구해서 사용자에게 명시적으로 식별 요청을 할 수 있습니다.
- 웹 사이트 로그인이 더 쉽도록 HTTP는 WWW-Authenticate와 Authorization 헤더를 사용해 웹 사이트에 사용자 이름을 전달하는 자체적인 체계를 가지고 있습니다.
- 서버에서 사용자가 사이트에 접근하기 전에 로그인을 시키고자 한다면 HTTP 401 Login Required 응답 코드를 브라우저에 보낼 수 있습니다.

<br/>

## 11.5 뚱뚱한 URL

- 어떤 웹 사이트는 사용자의 URL마다 버전을 기술하여 사용자를 식별하고 추적하였습니다.
- 사용자의 상태 정보를 포함하고 있는 URL을 뚱뚱한 URL이라고 합니다.
- 웹 서버와 통신하는 독립적인 HTTP 트랜잭션을 하나의 세션 혹은 방문으로 묶는 용도로 뚱뚱한 URL을 사용할 수 있습니다.
- 뚱뚱한 URL은 사이트를 브라우징하는 사용자를 식별하는데 사용할 수 있습니다.

하지만 아래의 문제가 있습니다.

- 못생긴 URL
  - 브라우저에 보이는 뚱뚱한 URL은 새로운 사용자들에게 혼란을 줍니다.
- 공유하지 못하는 URL
  - 뚱뚱한 URL은 특정 사용자와 세션에 대한 상태 정보를 포함하며 공유하기 어렵습니다.
- 캐시를 사용할 수 없음
  - URL로 만드는 것은, URL이 달라지기 때문에 기존 캐시에 접근할 수 없다는 것을 의미합니다.
- 서버 부하 가중
  - 서버는 뚱뚱한 URL에 해당하는 HTML 페이지를 다시 그려야합니다.
- 이탈
  - 사용자가 링크를 타고 다른 사이트로 이동하는 경우, 뚱뚱한 URL 세션에서 이탈하기가 쉽습니다.
- 세션 간 지속간의 부재
  - 사용자가 특정 뚱뚱한 URL을 북마킹하지 않는 이상, 로그아웃시 모든 정보를 잃습니다.

<br/>

## 11.6 쿠키

### 쿠키의 타입

### 쿠키는 어떻게 동작하는가

### 쿠키의 상자 : 클라이언트 측 상태

### 사이트마다 각기 다른 쿠키들

### 쿠키 구성요소

### Version 0(넷스케이프) 쿠키

### Version 1 (RFC 2965) 쿠키

### 쿠키와 세션 추적

### 쿠키와 캐싱

### 쿠키, 보안 그리고 개인정보

<br/>

## 추가 정보
