---
sidebar_position: 4
---

# 4. 커넥션 관리

다음에 대해 정리합니다.

- HTTP는 어떻게 TCP 커넥션을 사용하는지
- TCP 커넥션의 지연, 병목, 막힘
- 병렬 커넥션, keep-alive 커넥션, 커넥션 파이프라인을 활용한 HTTP의 최적화
- 커넥션 관리를 위해 따라야 할 규칙들

## 4.1 TCP 커넥션

![웹 동작 원리](https://user-images.githubusercontent.com/42582516/128624351-6778af45-0567-4633-bb14-9d8a93a8075b.png)

URL을 통해 웹 정보를 가져오는 경우?

1. 브라우저가 `www.목적지.com` 에서 호스트 명을 추출합니다.
2. 브라우저가 이 호스트명에 대한 ip 주소를 찾습니다.
3. 브라우저가 포트 번호를 얻습니다.
4. 브라우저가 해당 ip의 포트 번호로 TCP 커넥션을 생성합니다.
5. 브라우저가 서버로 HTTP GET 요청 메시지를 보냅니다.
6. 브라우저가 서버에서 온 HTTP 응답 메시지를 읽습니다.
7. 브라우저가 커넥션을 끊습니다.

### 신뢰할 수 있는 데이터 전송 통로 TCP

- HTTP는 몇몇 사용 규칙을 제외하고는 TCP 커넥션에 불과합니다.
- HTTP에게 신뢰할 만한 통신 방식을 제공하며 순서에 맞게 정확하게 전달합니다.

### TCP 스트림은 세그먼트로 나뉘어 IP 패킷을 통해 전송합니다.

- TCP는 IP 패킷(혹은 IP 데이터그램)이라고 불리는 작은 조각을 통해 데이터를 전송합니다.
- HTTP는 `IP, TCP, HTTP`로 구성된 `프로토콜 스택`에서 최상위 계층입니다.

![HTTP-HTTPS](https://user-images.githubusercontent.com/42582516/128624857-a78457a9-9d74-4c22-832d-19965c10f447.png)

- HTTP가 메시지를 전송하고자 할 경우, 현재 연결되어 있는 TCP 커넥션을 통해서 메시지 데이터의 내용을 순서대로 보냅니다.
- TCP는 세그먼트라는 단위로 데이터 스크림을 잘게 나누고, 세그먼트를 IP 패킷이라고 불리는 봉투에 담아서 인터넷을 통해 데이터를 전달합니다.
- 일반적으로 IP 패킷들은 각각을 포함합니다.
  - IP 패킷 헤더(보통 20바이트)
  - TCP 세그먼트 헤더(보통 20바이트)
  - TCP 데이터 조각(0 혹은 그 이상의 바이트)

![image](https://user-images.githubusercontent.com/42582516/128624959-5be87ff2-0814-4761-ae0b-50e6ae209564.png)

### TCP 커넥션 유지하기

- 컴퓨터는 항상 TCP 커넥션을 여러 개 가지고 있습니다.
- TCP 커넥션은 다음 4가지 값으로 식별합니다.
  - 발신자 IP 주소, 발신지 포트, 수신지 IP 주소, 수신지 포트
  - 네가지 값을 통해서 유일한 커넥션을 생성합니다.

### TCP 소켓 프로그래밍

- 운영체제는 TCP z커넥션의 생성과 관련된 여러 기능을 제공합니다.
- 소켓 API는 대부분의 OS와 프로그램 언어에서 사용가능합니다.
  - socket, bind, connect, listen, accept, read, write, close 등등이 있습니다.
- 소켓 API를 사용하면 TcP 종단 데이터 구조를 생성하고, 원격 서버의 TCP 종단에 그 종단 데이터 구조를 연결하여 데이터 스트림을 읽고 쓸 수 있습니다.

다음의 진행과정을 거칩니다.

![TCP_Socket_Programming](https://user-images.githubusercontent.com/42582516/128625109-806ee82a-a8ed-4eed-8d11-16ea860b5ff1.png)

<br/>

## 4.2 TCP의 성능에 대한 고려

<br/>

## 4.3 HTTP 커넥션 관리

<br/>

## 4.4 병렬 커넥션

<br/>

## 4.5 지속 커넥션

<br/>

## 4.6 파이프라인 커넥션

<br/>

## 4.7 커넥션 끊기에 대한 미스터리

<br/>

## 4.8 추가 정보
