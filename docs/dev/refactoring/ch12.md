---
sidebar_position: 12
---

# 12. 상속 다루기

- 특정 기능을 상속 계층구조의 위나 아래로 옮겨야 하는 상황 -> 메서드 올리기, 필드 올리기, 생성자 본문 올리기, 메서드 내리기, 필드 내리기
- 계층 사이에 클래스를 추가하거나 제거하는 리팩터링 -> 슈퍼클래스 추출하기, 서브클래스 제거하기, 계층 합치기
- 필드 값에 따라 동작이 달라지는 경우, 서브클래스로 대체하고 싶다면 -> 타입 코드를 서브클래스로 바꾸기
- 잘못된 곳에서 사용되거나 환경이 변해 문제가 생기는 경우 -> 서브클래스를 위임으로 바꾸기, 슈퍼클래스를 위임으로 바꾸기

## 12.1 메서드 올리기

```js
// before
class Employee { ... }
class Salesperson extends Employee {
  get name() {...}
}
class Engineer extends Employee {
  get name() {...}
}

// after
class Employee {
  get name() {...}
}
class Salesperson extends Employee {...}
class Engineer extends Employee {...}
```

### 배경

- 중복 코드 제거는 중요한 역할을 의미합니다.
- 메서드 올리기를 적용하기에 가장 이상하고 복잡한 상황은 해당 메서드의 본문에서 참조하는 필드들이 서브클래에만 있는 경우입니다.
- 두 메서드의 전체 흐름은 비슷하지만 세부 내용이 다르다면 템플릿 메서드를 만드는 것도 고려합니다.

### 절차

1. 똑같이 동작하는 메서드인지 면밀하게 살펴봅니다.
2. 메서드 안에서 호출하는 다른 메서드와 참조하는 필드들을 슈퍼클래스에서도 호출하고 참조할 수 있는지 확인합니다.
3. 메서드 시그니처가 다르다면 함수 선언 바꾸기로 슈퍼클래스에서 사용하고 싶은 형태로 통일합니다.
4. 슈퍼클래스에 새로운 메서드를 생성하고, 대상 메서드의 코드를 복사해넣습니다.
5. 정적 검사를 수행합니다.
6. 서브클래스 중 하나의 메서드를 제거합니다.
7. 테스트합니다.
8. 모든 서브클래스의 메서드가 없어질 때까지 다른 서브클래스의 메서드를 하나씩 제거합니다.

### 예시

```js
class Employee extends Party {
  get annualCost() {
    return this.monthlyCost * 12
  }
}
class Department extends Party {
  get annualCost() {
    return this.monthlyCost * 12
  }
}
```

- 다음의 공통 코드를 슈퍼클래스에 넣습니다.

```js
class Party {
  get annualCost() {
    return this.monthlyCost * 12
  }
}
```

<br/>

## 12.2 필드 올리기

```java
// before
class Employee {...}
class Salesperson extends Employee {
  private String name;
}
class Engineer extends Employee {
  private String name;
}

// after
class Employee {
  private String name;
}
class Salesperson extends Employee {...}
class Engineer extends Employee {...}
```

### 배경

- 비슷한 방식으로 필드들이 사용된다고 판단되면 슈퍼클래스로 올리는 것이 좋습니다.
  - 첫째, 데이터 중복 선언을 없앨 수 있습니다.
  - 둘째, 해당 필드를 사용하는 동작을 서브클래스에서 슈퍼클래스로 옮길 수 있습니다.

### 절차

1. 후보 필드들을 사용하는 곳 모두가 그 필드들을 똑같은 방식으로 사용하는지 면밀히 살핍니다.
2. 필드들의 이름이 각각 다르다면 똑같은 이름으로 바꿉니다.
3. 슈퍼클래스에 새로운 필드를 생성합니다.
4. 서브클래스의 필드를 제거합니다.
5. 테스트합니다.

<br/>

## 12.3 생성자 본문 올리기

```js
// before
class Party {...}
class Employee extends Party {
  constructor(name, id, monthlyCost) {
    super()
    this._id = id;
    this._name = name;
    this._monthlyCost  = monthlyCost
  }
}

// after
class Party {
  constructor(name) {
    this._name = name
  }
}
class Employee extends Party {
  constructor(name, id, monthlyCost) {
    super(name)
    this._id = id;
    this._monthlyCost  = monthlyCost
  }
}
```

### 배경

- 서브클래스들에서 기능이 같은 메서드들을 발견하면 함수 추출하기와 메서드 올리기를 차례로 적용하여 말끔히 슈퍼클래소 옮기면 좋습니다.

### 절차

1. 슈퍼클래스에 생성자가 없다면 하나 정의합니다. 서브클래스의 생성자들에서 이 생성자가 호출되는지 확인합니다.
2. 문장 슬라이드하기로 공통 문장 모두를 super() 호출 직후로 옮깁니다.
3. 공통 코드를 슈퍼클래스에 추가하고 서브클래스들에서는 제거합니다. 생성자 매개변수 중 공통 코드에서 참조하는 값들을 모두 super()로 건넵니다.
4. 테스트합니다.
5. 생성자 시작 부분으로 옮길 수 없는 공통 코드에는 함수 추출하기와 메서드 올리기를 차례로 적용합니다.

### 예시

```js
class Party {}
class Employee extends Party {
  constructor(name, id, monthlyCost) {
    super()
    this._id = id
    this._name = name
    this._monthlyCost = monthlyCost
  }
  // 생략
}
class Department extends Party {
  constructor(name, staff) {
    super()
    this._name = name
    this._staff = staff
  }
  // 생략
}
```

- 리팩토링 이후는 다음과 같습니다.

```js
class Party {
  constructor(name) {
    this._name = name
  }
}
class Employee extends Party {
  constructor(name, id, monthlyCost) {
    super(name)
    this._id = id
    this._monthlyCost = monthlyCost
  }
  // 생략
}
class Department extends Party {
  constructor(name, staff) {
    super(name)
    this._staff = staff
  }
  // 생략
}
```

<br/>

## 12.4 메서드 내리기

<br/>

## 12.5 필드 내리기

<br/>

## 12.6 타입 코드를 서브클래스로 바꾸기

<br/>

## 12.7 서브클래스 제거하기

<br/>

## 12.8 슈퍼클래스 추출하기

<br/>

## 12.9 계층 합치기

<br/>

## 12.10 서브클래스를 위임으로 바꾸기

<br/>

## 12.11 슈퍼클래스를 위임으로 바꾸기
