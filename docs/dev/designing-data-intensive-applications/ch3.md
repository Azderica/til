---
sidebar_position: 3
---

# 3. 저장소와 검색

> 항상 주변을 단정히 정돈하는 사람은 단지 찾기를 너무 귀찮아하는 사람이다.

데이터베이스는 기본적으로 데이터를 저장하고 요청하는 기능을 제공합니다.

아래에서는 관계형 데이터베이스와 소위 NoSQL라 불리는 데이터베이스에 사용되는 저장소 엔진에 대해 설명합니다. **로그 구조(log-structured)** 장소 엔진과 B-tree 같은 **페이지 지향(page-oriented)** 계열 저장소에 엔진에 대해 이야기합니다.

## 데이터베이스를 강력하게 만드는 데이터 구조

- 많은 데이터베이스는 내부적으로 추가 적용 데이터 파일인 **로그(log)** 를 사용합니다.
- **색인**을 통해서 데이터베이스에서 특정 키의 값을 효율적으로 찾습니다.
- 색인을 잘 쓰면 읽기 쓰기를 올릴 수 있으나, 모든 색인은 쓰기 속도를 떨어트립니다.

### 해시 색인

- 키-값 저장소는 대부분의 프로그래밍 언어에서 볼 수 있는 **사전 타입(dictionary type)** 과 매우 유사합니다.
- 일반적으로 해시 색인을 구성하는 방법은 **오프셋을 사용해서 저장하는 방식**과 **특정 크기의  세그먼트로 로그를 나누는 방식**으로 나눠집니다.
  - 오프셋을 사용하면 단순하지만, 키 값 갱신이 자주 일어날 때 장점을 가집니다. 그러나 용량에서 단점을 가집니다.
  - 특정 크기의 세그먼트로 나누는 방식을 통해 컴팩션을 수행할 수 있습니다. 즉 최신 정보만 유지합니다.이 경우는 키 파일 오프셋 매핑 자체 인메모리 해시 테이블을 가집니다.

#### 해시 색인의 추가 전용 로그 장점

- 추가와 세그먼트 병합은 순차적인 쓰기 작업이기에 무작위 쓰기보다 빠릅니다.
- 세그먼트 파일이 추가 전용이거나 불변이면 동시성과 고장 복구가 훨씬 간단합니다.
- 오래된 세그먼트 병합은 시간이 지남에 따라 조각화되는 데이터 파일 문제를 피할 수 있습니다.

#### 해시 색인의 단점

- 해시 테이블은 메모리에 저장해야 하므로 키가 너무 많으며 문제가 됩니다.
- 해시 테이블은 범위 질의(range query)에 비효율적입니다.



<br/>

## 트랜잭션 처리나 분석

<br/>

## 칼럼 지향 저장소

<br/>

## 정리
