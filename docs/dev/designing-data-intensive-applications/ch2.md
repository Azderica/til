---
sidebar_position: 2
---

# 2. 데이터 모델과 질의 언어

> 내 언어의 한계는 내 세계의 한계를 의미합니다.

- 데이터 모델은 소프트웨어가 어떻게 작성됐는지 뿐만 아니라 **해결하려는 문제에 대해 고민**해봐야합니다.
- 각 계층의 핵심적인 문제는 다음 하위 계층 관점에서 데이터 모델을 **표현**하는 방법입니다.
- 각 계층은 명확한 데이터 모델을 제공해 하위 계층의 복잡성을 숨깁니다.

## 관계형 모델과 문서 모델

- 가장 유명한 데이터 모델은 RDBMS인 관계형 모델입니다.
- 목적은 **비즈니스 데이터 처리**이며 **트랜잭션 처리**와 **일괄 처리**를 수행합니다.
- 현대로 넘어오면서 관계형 데이터베이스가 비지니스 데이터를 넘어서 폭넓은 분야에서도 사용되고 있습니다.

### NoSQL의 탄생

NoSQL의 채택 이유는 다음과 같습니다.

- 대규모 데이터셋이나 매우 높은 쓰기 처리량 달성을 관계형 데이터베이스보다 쉽게 할 수 있는 뛰어난 확장성이 필요합니다.
- 상용 데이터베이스 보다 오픈소스 소프트웨어에 대한 선호도 확산
- 관계형 모델에서 지원하지 않는 특수 질의 동작
- 관계형 스키마의 제한에 대한 불만과 더욱 동적이고 표현력이 풍부한 데이터 모델에 대한 바람

현재는 관계형 데이터베이스와 비관계형 데이터스토어를 함께 사용하며, 이러한 개념을 **다중 저장소 지속성(polyglot persistence)** 라고 합니다.

### 객체 관계형 불일치

- 대부분의 애플리케이션은 객체지향 프로그래밍 언어로 개발하며 이는 관계형 데이터 모델과의 **불필요한 전환 계층**이 필요합니다. 이러한 분리를 **임피던스 불일치(impedance mismatch)**라고 부릅니다.

### 링크드인 프로필 예시

```plain
[사진] 빌 게이츠 / 그레이터 시애틀 구역 | 자선활동

요약
- 빌 & 멜린다 게이츠 재단 공당 의장
- 마이크로소프트 기업 회장
- ...

경력
- 빌 & 멜린다 게이츠 재단 공동 의장 (2000 ~)
- 마이크로소프트 공동 창업자, 회장 (1975 ~)

학력
- 하버드 대학교(1973-1975)
- 레이크사이드 스쿨, 시애틀

연락처
- 블로그: ...
- 트위터: ...
```

#### 관계형 스키마로 표현한 링크드인 프로필

![관계형 스키마 예시](https://user-images.githubusercontent.com/42582516/135734791-fcc1e5da-c13d-4a44-acbd-4ac2096062b7.png)

#### JSON 문서로 표현한 링크드인 프로필

데이터

```json
{
  "user_id": 251,
  "first_name": "Bill",
  "last_name": "Gates",
  "summary": "Co-chair of the Bill & ....",
  "region_id": "us:91",
  "industry_id": 131,
  "photo_url": "/p/7/000/253/08b/308dd6e.jpg",
  "positions": [
    {
      "job_title": "Co-chair",
      "organization": "Bill & Melinda Gates Foundation"
    },
    { "job_title": "Co-founder", "organization": "Microsoft" }
  ],
  "educations": [
    { "school_name": "Harvard University", "start": 1973, "end": 1975 },
    { "school_name": "Lakeside School, Seattle", "start": null, "end": null }
  ],
  "contact_info": {
    "blog": "http://thegatesnotes.com",
    "twitter": "http://twitter.com/BillGates"
  }
}
```

- 다중 테이블 스키마보다는 더 나은 **지역성(locality)** 를 가집니다.

> 지역성이란?

데이터 접근이 시각적, 공간적으로 가깝게 일어나는 것을 말합니다.

### 다대일과 다대다 관계

위의 예시에서 구역이나 활동등은 ID로 표현하였는데, 이런 식으로 표준 목록으로 관리하게 되면 아래의 장점을 가집니다.

- 프로필 간 일관된 스타일과 철자
- 모호함 회피
- 갱신의 편의성 (이름 변경 등이 쉽습니다.)
- 현지화 지원 (사이트를 다른 언어로 번역시 유리합니다.)
- 더 나은 검색 서비스를 만들기 쉽습니다.

중복된 데이터를 정규화하려면 **다대일(many-to-one)** 관계가 필요하지만 이는 문서 모델에 적합하지 않습니다.

다대다 관계.

### 문서 데이터베이스는 역사를 반복하고 있는가

- 관계형 데이터베이스는 **다대다 관계**와 **조인**을 주로 사용을 합니다.
- 최초 1970년도의 비지니스 데이터 처리를 위해 가장 많이 사용된 데이터베이스는 IMS라 불리는 **계층 모델**이였습니다.
  - 현재의 JSON과 비슷합니다.
  - 일대다 관계에서는 잘 동작합니다. 다만 다대다 관계 표현의 어려움과 조인의 미지원이라는 단점이 있습니다.
- 이러한 계층 모델의 한계를 해결하기 위해 **관계형 모델(SQL)** 과 **네트워크 모델**이 등장했습니다.

#### 네트워크 모델

![코다실 모델](https://user-images.githubusercontent.com/42582516/135743803-5c5d635c-326b-4eee-b497-b153c6a16b83.png)

- **코다실 모델**이라고도 불립니다.
- 계층 모델을 일반화하며 계층 모델의 트리 구조에서는 모든 레코드는 정확하게 하나의 부모가 있습니다.
- 레코드에 접근하는 유일한 방법은 최상위 레코드에서부터 연속된 연결 경로를 따르는 방법이며 이를 **접근 경로**라 부릅니다.
- 수동 접근 경로 선택은 데이터베이스 질의와 갱신을 위한 **코드가 복잡하고 유연하지 못하고, 데이터 모델을 바꾸기도 힘들어집니다.**

#### 관계형 모델

- 관계형 모델은 단순히 튜플(로우)의 컬렉션이 전부입니다.
- 데이터에 질의하고 싶은 경우 새로운 색인을 선언하기만 하면 질의는 **자동으로 가장 적합한 색인을 사용**합니다.
- 관계형 모델은 애플리케이션에 새로운 기능을 추가하는 작업이 훨씬 쉽습니다.

#### 문서 데이터베이스와의 비교

- 다대일과 다대다 관계를 표현할 때 관계형 데이터베이스와 문서 데이터베이스는 모두 고유한 식별자를 참조합니다.
- 관계형 모델에서는 **외래 키**라 부르고 문서 모델에서는 **문서 참조(document reference)**라고 부릅니다.

### 관계형 데이터베이스와 오늘날의 문서 데이터베이스

#### 어떤 데이터 모델이 애플리케이션 코드를 더 간단하게 할까?

#### 문서 모델에서의 스키마 유연성

#### 질의를 위한 데이터 지역성

#### 문서 데이터베이스와 관계형 데이터베이스의 통합

<br/>

## 데이터를 위한 질의 언어

<br/>

## 그래프형 데이터 모델

<br/>

## 정리
