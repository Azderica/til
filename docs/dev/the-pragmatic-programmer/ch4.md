---
sidebar_position: 4
---

# 4. 실용주의 편집증

> Tip 30. 완벽한 소프트웨어는 만들 수 없다.

## Item 21. 계약에 의한 설계

> 상식과 정직만큼 사람을 놀라게 하는 건 없다.

- 컴퓨터 시스템은 어려우나 사람 문제가 더 어렵습니다.
- 계약은 상대와 나의 권리와 책임을 정의합니다.
- 계약과 마찬가지로 소프트웨어 모듈이 소통하는 것을 돕기 위해 동일 개념을 사용하는 것 또한 가능합니다.

### DBC

- 계약에 의한 설계 개념
- 프로그램의 정확성을 보장하기 위해 소프트웨어 모듈들의 권리와 책임을 문서화하는 데에 초점을 맞춥니다.
- 정확한 프로그램이란 설계한 그대로 그만큼만 하는 프로그램을 말하며 이 주장을 문서화하고 검증하는 것이 계약에 의한 설계(Design By Contract, DBC)의 핵심입니다.
- 다음의 루틴을 준수합니다.
  - **선행조건(precondition)** : 루틴을 호출되기 위해 참이어야 하는 것, 루틴의 요구사항
  - **후행조건(postcondition)** : 루틴이 자기가 할 것이라고 보장하는 것, 루틴이 완료되었을 때 세상의 상태
  - **클래스 불변식(class invariant)** :호출자의 칩장에서 언제나 참임을 클래스가 보장

```java
// DBC를 보여주는 자바 예제.
/**
 * @invariant forall Node n in elements()
 *   n.prev() != null
 *     implies
 *       n.value().compareTo(n.prev().value()) > 0
 */
 public class dbc_list {
   /**
     * @pre contains(aNode) == false
     * @post contains(aNode) == true
     */
   public void insertNode(final Node aNode) {
    //...
   }
 }

```

- 루틴과 루틴의 잠재적 호출자 간의 계약은 다음과 같습니다.
  - _만약 호출자가 루틴의 모든 선행조건을 충족한다면, 해당 루틴은 종료시 모든 후행조건과 불변식이 참이 될 것을 보증해야 합니다._

> Tip 31. 계약에 따른 설계를 해라

- 즉, 직교성에서는 shy 코드를 작성했다면 여기서는 lazy 코드입니다.
- 수용할 것에 대해서는 엄격하게 하고, 내어줄 것에 대해서는 최소한도를 약속하는 것이 중요합니다.
- 상속성과 다형성은 여기서 특히 더 중요합니다. 즉 **리스코드 대체 규칙**을 준수하는 것이 중요합니다.
  - _서브클래스는 사용자가 차이점을 모르고서도 기반 클래스 인터페이스를 통해 사용할 수 있어야 한다._

### DBC 구현

- DBC의 최고 장점은 요구사항과 보증의 문제를 전면으로 내세운다는 것입니다.
- DBC는 결국 설계 기법이며 코드에서 지원하지 않아 자동검사가 안되더라도 주석으로 넣고 문제가 발생했을 때 우선적으로 봐야할 곳이 됩니다.

#### 단정문

### DBC와 일찍 멈추기

### 불변식과 일찍 멈추기

### 동적 계약과 에이전트

<br/>

## Item 22. 죽은 프로그램은 거짓말을 하지 않는다

<br/>

## Item 23. 단정적 프로그래밍

<br/>

## Item 24. 언제 예외를 사용할까

<br/>

## Item 25. 리소스 사용의 균형
