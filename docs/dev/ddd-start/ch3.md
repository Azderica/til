---
sidebar_position: 3
---

# 3. 애그리거트

## 애그리거트

- 상위 수준의 모델을 정리하여 복잡한 도메인 모델의 관계를 이해하는 데 도움이 됩니다.

![상위 수준의 모델을 정리하여 복잡한 도메인 모델의 관계를 이해할 수 있습니다.](https://user-images.githubusercontent.com/42582516/150660303-25e073f8-f103-4046-bc4d-c193b34251e9.png)

- 이를 개별 객체 수준으로 보면 다음과 같이 정리할 수 있습니다.

![개별 객체 수준에서 모델은 상위 수준에서 관계 파악이 어렵습니다.](https://user-images.githubusercontent.com/42582516/150660427-866da8dd-e986-4fd0-b39b-68c179d72e10.png)

- 개별 객체 수준에서 모델은 상위 수준에서 관계 파악이 어렵습니다.
- 주요 도메인 개념 간의 관계를 파악하기 어렵다는 것은 곧 코드를 변경하고 확장하는 것이 어려워짐을 의미합니다.
- 복잡한 도메인을 이해하고 관리하기 쉬운 단위로 만들려면 상위 수준에서 모델을 조망할 수 있는 방법이 필요하며, 그 방법이 바로 애그리거트입니다.

![애그리거트는 복잡한 모델을 관리하는 기준을 제공합니다.](https://user-images.githubusercontent.com/42582516/150660566-f6ed55db-7b57-408e-b624-ddf3c87d9552.png)

- 애그리거트는 모델을 이해하는 데 도움을 줄 뿐만 아니라 일관성을 관리하는 기준이 됩니다.
  - 복잡도가 낮아지므로 도메인 기능을 확장하고 변경하는 데 필요한 노력도 줄어듭니다.
- 애그리거트는 관련된 모델을 하나로 모든 것이기 때문에 한 애그리거트에 속한 객체는 유사하거나 동일한 라이프사이클을 갖습니다.
- 경계를 설정할 때 기본이 되는 것은 도메인 규칙과 요구사항입니다.
- 다만, 'A가 B를 갖는다'로 설계할 수 있는 요구사항이 있다면 A와 B를 한 애그리거트로 묶어서 생각하기 쉬우나 이는 아닙니다.
  - 대표적인 예시로, 상품과 리뷰입니다.
  - 상품의 변경 주체는 상품 담당자고 리뷰를 생산하고 변경하는 주체는 고객이며, 또한 둘은 서로에게 영향을 주지 않습니다.
- 처음 도메인 모델을 만들기 시작할 때는 큰 애그리거트로 보이는 것들이 많지만 도메인에 대한 경험과 규칙을 통해 실제 애그리거트의 크기는 줄어들게 됩니다.
  - 대부분 애그리거트는 한 개의 엔티티 객체만 가지며, 일부만 두 개 이상의 엔티티로 구성됩니다.

<br/>

## 애그리거트 루트

### 도메인 규칙과 일관성

### 애그리거트 루트의 기능 구현

### 트랜잭션 범위

<br/>

## 리포지터리와 애그리거트

<br/>

## ID를 이용한 애그리거트 참조

### ID를 이용한 참조와 조회 성능

<br/>

## 애그리거트 간 집합 연관

<br/>

## 애그리거트를 팩토리로 사용하기
