---
sidebar_position: 2
---

# 2. 개략적인 규모 추정

## 2의 제곱수

|2의 x제곱|근사치|이름|축약어
|-|-|-|-|
|10|1천(thousand)|1킬로바이트(Kilobyte)|1KB|
|20|1백만(million)|1메카바이트(Megabyte)|1MB|
|30|10억(billion)|1기가바이트(Gigabyte)|1GB|
|40|1조(trillion)|1테라바이트(Terabyte)|1TB|
|50|1000조(quadrillion)|1페타바이트(Petabyte)|1PB|

<br/>

## 모든 프로그래머가 알아야 하는 응답지연 값

- 2020년 기준으로 응답 지연 값은 다음과 같습니다.

|연산명|시간|
|-|-|
|L1 캐시 참조|1ns|
|분기 예측 오류|3ns|
|L2 캐시 참조|4ns|
|뮤텍스 락/언락|17ns|
|주 메모리 참조|100ns|
|Zippy로 1kb 압축|2,000ns|
|일반 상용 네트워크상에서 2Kb바이트 전송|44ns|
|메모리에서 1M바이트 순차적으로 읽기|3,000ns|
|SSD 상에서 임의 위치의 데이터 읽기|16,000ns|
|SSD 상에서 1M 바이트 순차적 읽기|49,000ns|
|디스크 탐색|2,000,000ns = 2ms|
|디스크에서 1M바이트 순차적 읽기|825,000ns|
|동일 데이터 센터 내에서의 패킷왕복 지연시간|500,000ns|
|CA에서 네덜란드까지의 패킷 왕복 지연시간|150,000,000ns = 150ms|

- 다음과 같은 결론을 얻을 수 있습니다.
  - 메모리는 빠르지만 디스크는 아직도 느리다
  - 디스크 탐색(seek)은 가능한 한 피하라
  - 단순한 압축 알고리즘은 빠르다
  - 데이터를 인터넷으로 전송하기 전에 가능하면 압축하라
  - 데이터 센터는 보통 여러 지역(region)에 분산되어 있고, 센터들 간에 데이터를 주고받는 데는 시간이 걸립니다.

<br/>

## 가용성에 관계된 수치들

- 고가용성(high availability)은 시스템이 오랜 시간 동안 지속적으로 중단 없이 운영될 수 있는 능력을 지칭합니다.
- 대부분의 서비스는 99%에서 100% 사이의 값을 갖습니다.

|가용률|하루당 장애시간|주당 장애시간|개월당 장애시간|연간 장애시간|
|-|-|-|-|-|
|99%|14.40분|1.68시간|7.31시간|3.65일|
|99.9%|1.44분|10.08분|43.83분|8.77시간|
|99.99%|8.64초|1.01분|4.38분|52.60분|
|99.999%|864.00밀리초|6.05초|26.30초|5.26분|
|99.9999%|86.40밀리초|604.80밀리초|2.63초|31.56초|

<br/>

## 예제: 트위터 QPS와 저장소 요구량 추정

- 가정
  - 월간 능동 사용자(motnly active user)은 3억(300million) 명입니다.
  - 50%의 사용자가 트위터를 매일 사용한다
  - 평균적으로 각 사용자는 매일 2건의 트윗을 올린다
  - 미디어를 포함하는 트윗은 10%정도이다.
  - 데이터는 5년간 보관된다
- 추정
  - QPS(Query Per Second) 추정치
    - 일간 능동 사용자(Daily Active User, DAU) = 3억 * 50% = 1.5억(150million)
    - QPS = 1.5억 * 2 트윗/24시간/3600초 = 약 3500
    - 최대 QPS(Peek QPS) = 2 * QPS = 약 7000
  - 미디어 저장을 위한 저장소 요구량
    - 평균 트윗 크기
      - tweet_id에 64바이트
      - 텍스트에 140바이트
      - 미디어에 1MB
    - 미디어 저장소 요구량 : 1.5억 * 2 * 10% * 1MB = 30TB/일
    - 5년간 미디어를 보관하기 위한 저장소 요구량: 30TB * 365 * 5 = 약 55PB

<br/>

## 팁

- 면접에서 중요한 것은 문제를 풀어가는 절차가 중요합니다.
  - 근사치를 활용한 계산, 정확한 계산은 무의미하다
  - 가정(assumption)을 적어두기
  - 단위(unit)을 붙이기
  - 많이 출제되는 개략적 규모 추정 문제는 **QPS, 최대 QPS, 저장소 요구량, 캐시 요구량, 서버 수 등**을 추정하는 것입니다.
