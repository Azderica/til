---
sidebar_position: 14
---

# 14장. 유튜브 설계

- 아래는 유튜브 설계에 대한 내용입니다.

유튜브의 2020년 통계자료는 다음과 같습니다.

- 월간 능동 사용자 수: 2십 억
- 매일 재생되는 비디오 수: 5십 억
- 미국 성인 가운데 73%가 유튜브 이용
- 5천만 명의 창작자
- 유튜브의 광고 수입은 증가 중
- 모바일 인터넷 트래픽 가운데 37%를 유튜브가 점유
- 80개의 언어로 이용 가능

## 1단계 문제 이해 및 설계 범위 확정

- 다음의 설계에 초점을 맞춥니다.
  - 빠른 비디오 업로드
  - 원활한 비디오 재생
  - 재생 품질 선택 기능
  - 낮은 인프라 비용
  - 높은 가용성과 규모 확장성, 그리고 안정성
  - 지원 클라이언트: 모바일 앱, 웹브라우저, 그리고 스마트 TV

### 개략적 규모 추정

- 일간 능동 사용자(DAU, Daily Activie User) 수는 5백만
- 한 사용자는 하루에 평균 5개의 비디오를 시청
- 10% 사용자가 하루에 1비디오 업로드
- 비디오 평균 크기는 300MB
- 비디오 저장을 위해 매일 새로 요구되는 저장용량 : 5백만 * 10% * 300MB = 150TB
- CDN 비용(아마존 사용시) : 5백만 X 5비디오 * 0.3GB * 0.2 = $150,000

<br/>

## 2단계 개략적 설계안 제시 및 동의 구하기

- 시스템 설계 면접은 모든 것을 밑바닥부터 만드는 것과는 관계가 없습니다. 주어진 시간 안에 적절한 기술을 골라 설계를 마치는 것이 그 기굴 각각이 어떻게 동작하는지 상세히 설명하는 것보다 중요합니다.
- 시스템은 세 개의 컴포넌트로 구성됩니다.
  - 단말(client) : 컴퓨터, 모바일 폰, 스마트 TV를 통해 유튜브 시청 가능
  - CDN: 비디오는 CDN에 저장합니다.
  - API 서버: 비디오 스트리밍을 제외한 모든 요청은 API 서버가 처리합니다.

### 비디오 업로드 절차

![비디오 업로드 절차](https://user-images.githubusercontent.com/42582516/191521670-b9b2caad-3d71-46d6-b99a-eb823241df06.png)

- 트랜스코딩 서버: 비디오 트랜스코딩은 비디오 인코딩이라 부르는 절차입니다.
- 트랜스코딩 비디오 저장소: 트랜스코딩이 완료된 비디오를 저장하는 BLOB 저장소입니다.
- CDN: 비디오를 캐싱하는 역할을 담당합니다.
- 트랜스코딩 완료 큐: 비디오 트랜스코딩 완료 이벤트를 보관할 메시지 큐
- 트랜스코딩 완료 핸들러: 트랜스코딩 완료 큐에서 이벤트 데이터를 꺼내어 메타데이터 캐시와 데이터베이스를 갱신할 작업 서버들입니다.

### 비디오 스트리밍 절차

- 비디오는 CDN에서 바로 스트리밍됩니다.

<br/>

## 3단계 상세 설계

<br/>

## 4단계 마무리
